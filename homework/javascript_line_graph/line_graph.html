<!DOCTYPE html>

<html>
  <head>

  </head>
  <body>
    <textarea id="rawdata">
      [["2014/01/01", "99"], ["2014/01/02", "103"], ["2014/01/03", "122"], ["2014/01/04", "93"], ["2014/01/05", "84"], ["2014/01/06", "145"], ["2014/01/07", "123"], ["2014/01/08", "100"], ["2014/01/09", "121"], ["2014/01/10", "88"], ["2014/01/11", "78"], ["2014/01/12", "62"], ["2014/01/13", "99"], ["2014/01/14", "71"], ["2014/01/15", "64"], ["2014/01/16", "89"], ["2014/01/17", "90"], ["2014/01/18", "86"], ["2014/01/19", "71"], ["2014/01/20", "60"], ["2014/01/21", "54"], ["2014/01/22", "43"], ["2014/01/23", "52"], ["2014/01/24", "67"], ["2014/01/25", "63"], ["2014/01/26", "68"], ["2014/01/27", "62"], ["2014/01/28", "68"], ["2014/01/29", "25"], ["2014/01/30", "50"], ["2014/01/31", "74"], ["2014/02/01", "84"], ["2014/02/02", "80"], ["2014/02/03", "82"], ["2014/02/04", "94"], ["2014/02/05", "104"], ["2014/02/06", "96"], ["2014/02/07", "103"], ["2014/02/08", "90"], ["2014/02/09", "76"], ["2014/02/10", "90"], ["2014/02/11", "83"], ["2014/02/12", "91"], ["2014/02/13", "69"], ["2014/02/14", "88"], ["2014/02/15", "134"], ["2014/02/16", "94"], ["2014/02/17", "104"], ["2014/02/18", "80"], ["2014/02/19", "110"], ["2014/02/20", "100"], ["2014/02/21", "103"], ["2014/02/22", "103"], ["2014/02/23", "118"], ["2014/02/24", "126"], ["2014/02/25", "126"], ["2014/02/26", "111"], ["2014/02/27", "78"], ["2014/02/28", "85"], ["2014/03/01", "82"], ["2014/03/02", "98"], ["2014/03/03", "99"], ["2014/03/04", "107"], ["2014/03/05", "126"], ["2014/03/06", "137"], ["2014/03/07", "128"], ["2014/03/08", "160"], ["2014/03/09", "195"], ["2014/03/10", "180"], ["2014/03/11", "144"], ["2014/03/12", "168"], ["2014/03/13", "168"], ["2014/03/14", "120"], ["2014/03/15", "118"], ["2014/03/16", "122"], ["2014/03/17", "120"], ["2014/03/18", "105"], ["2014/03/19", "159"], ["2014/03/20", "212"], ["2014/03/21", "110"], ["2014/03/22", "105"], ["2014/03/23", "95"], ["2014/03/24", "109"], ["2014/03/25", "108"], ["2014/03/26", "96"], ["2014/03/27", "137"], ["2014/03/28", "173"], ["2014/03/29", "192"], ["2014/03/30", "202"], ["2014/03/31", "204"], ["2014/04/01", "204"], ["2014/04/02", "215"], ["2014/04/03", "227"], ["2014/04/04", "152"], ["2014/04/05", "177"], ["2014/04/06", "177"], ["2014/04/07", "212"], ["2014/04/08", "138"], ["2014/04/09", "148"], ["2014/04/10", "154"], ["2014/04/11", "153"], ["2014/04/12", "158"], ["2014/04/13", "131"], ["2014/04/14", "117"], ["2014/04/15", "107"], ["2014/04/16", "143"], ["2014/04/17", "176"], ["2014/04/18", "121"], ["2014/04/19", "166"], ["2014/04/20", "207"], ["2014/04/21", "158"], ["2014/04/22", "190"], ["2014/04/23", "211"], ["2014/04/24", "205"], ["2014/04/25", "237"], ["2014/04/26", "176"], ["2014/04/27", "153"], ["2014/04/28", "169"], ["2014/04/29", "175"], ["2014/04/30", "179"], ["2014/05/01", "183"], ["2014/05/02", "122"], ["2014/05/03", "137"], ["2014/05/04", "137"], ["2014/05/05", "184"], ["2014/05/06", "178"], ["2014/05/07", "162"], ["2014/05/08", "134"], ["2014/05/09", "161"], ["2014/05/10", "156"], ["2014/05/11", "117"], ["2014/05/12", "146"], ["2014/05/13", "150"], ["2014/05/14", "139"], ["2014/05/15", "150"], ["2014/05/16", "183"], ["2014/05/17", "207"], ["2014/05/18", "231"], ["2014/05/19", "243"], ["2014/05/20", "271"], ["2014/05/21", "215"], ["2014/05/22", "230"], ["2014/05/23", "207"], ["2014/05/24", "196"], ["2014/05/25", "213"], ["2014/05/26", "223"], ["2014/05/27", "174"], ["2014/05/28", "146"], ["2014/05/29", "118"], ["2014/05/30", "169"], ["2014/05/31", "194"], ["2014/06/01", "187"], ["2014/06/02", "206"], ["2014/06/03", "210"], ["2014/06/04", "178"], ["2014/06/05", "178"], ["2014/06/06", "229"], ["2014/06/07", "276"], ["2014/06/08", "248"], ["2014/06/09", "271"], ["2014/06/10", "258"], ["2014/06/11", "219"], ["2014/06/12", "229"], ["2014/06/13", "222"], ["2014/06/14", "189"], ["2014/06/15", "201"], ["2014/06/16", "178"], ["2014/06/17", "193"], ["2014/06/18", "200"], ["2014/06/19", "161"], ["2014/06/20", "180"], ["2014/06/21", "209"], ["2014/06/22", "206"], ["2014/06/23", "213"], ["2014/06/24", "213"], ["2014/06/25", "192"], ["2014/06/26", "222"], ["2014/06/27", "215"], ["2014/06/28", "210"], ["2014/06/29", "192"], ["2014/06/30", "186"], ["2014/07/01", "193"], ["2014/07/02", "209"], ["2014/07/03", "262"], ["2014/07/04", "289"], ["2014/07/05", "228"], ["2014/07/06", "244"], ["2014/07/07", "235"], ["2014/07/08", "170"], ["2014/07/09", "178"], ["2014/07/10", "276"], ["2014/07/11", "238"], ["2014/07/12", "245"], ["2014/07/13", "231"], ["2014/07/14", "227"], ["2014/07/15", "224"], ["2014/07/16", "258"], ["2014/07/17", "283"], ["2014/07/18", "311"], ["2014/07/19", "329"], ["2014/07/20", "272"], ["2014/07/21", "212"], ["2014/07/22", "272"], ["2014/07/23", "284"], ["2014/07/24", "263"], ["2014/07/25", "221"], ["2014/07/26", "251"], ["2014/07/27", "262"], ["2014/07/28", "235"], ["2014/07/29", "259"], ["2014/07/30", "235"], ["2014/07/31", "244"], ["2014/08/01", "259"], ["2014/08/02", "276"], ["2014/08/03", "253"], ["2014/08/04", "233"], ["2014/08/05", "243"], ["2014/08/06", "213"], ["2014/08/07", "230"], ["2014/08/08", "223"], ["2014/08/09", "231"], ["2014/08/10", "225"], ["2014/08/11", "207"], ["2014/08/12", "202"], ["2014/08/13", "217"], ["2014/08/14", "203"], ["2014/08/15", "197"], ["2014/08/16", "187"], ["2014/08/17", "167"], ["2014/08/18", "173"], ["2014/08/19", "159"], ["2014/08/20", "178"], ["2014/08/21", "182"], ["2014/08/22", "171"], ["2014/08/23", "174"], ["2014/08/24", "177"], ["2014/08/25", "169"], ["2014/08/26", "165"], ["2014/08/27", "207"], ["2014/08/28", "214"], ["2014/08/29", "212"], ["2014/08/30", "186"], ["2014/08/31", "190"], ["2014/09/01", "212"], ["2014/09/02", "212"], ["2014/09/03", "212"], ["2014/09/04", "235"], ["2014/09/05", "228"], ["2014/09/06", "205"], ["2014/09/07", "216"], ["2014/09/08", "205"], ["2014/09/09", "178"], ["2014/09/10", "184"], ["2014/09/11", "204"], ["2014/09/12", "216"], ["2014/09/13", "211"], ["2014/09/14", "209"], ["2014/09/15", "228"], ["2014/09/16", "246"], ["2014/09/17", "252"], ["2014/09/18", "253"], ["2014/09/19", "244"], ["2014/09/20", "240"], ["2014/09/21", "192"], ["2014/09/22", "175"], ["2014/09/23", "177"], ["2014/09/24", "165"], ["2014/09/25", "178"], ["2014/09/26", "194"], ["2014/09/27", "202"], ["2014/09/28", "220"], ["2014/09/29", "193"], ["2014/09/30", "209"], ["2014/10/01", "207"], ["2014/10/02", "192"], ["2014/10/03", "222"], ["2014/10/04", "211"], ["2014/10/05", "152"], ["2014/10/06", "161"], ["2014/10/07", "156"], ["2014/10/08", "166"], ["2014/10/09", "180"], ["2014/10/10", "178"], ["2014/10/11", "157"], ["2014/10/12", "162"], ["2014/10/13", "185"], ["2014/10/14", "136"], ["2014/10/15", "184"], ["2014/10/16", "180"], ["2014/10/17", "188"], ["2014/10/18", "230"], ["2014/10/19", "215"], ["2014/10/20", "177"], ["2014/10/21", "140"], ["2014/10/22", "135"], ["2014/10/23", "151"], ["2014/10/24", "126"], ["2014/10/25", "153"], ["2014/10/26", "159"], ["2014/10/27", "170"], ["2014/10/28", "140"], ["2014/10/29", "128"], ["2014/10/30", "156"], ["2014/10/31", "166"], ["2014/11/01", "185"], ["2014/11/02", "174"], ["2014/11/03", "153"], ["2014/11/04", "109"], ["2014/11/05", "95"], ["2014/11/06", "82"], ["2014/11/07", "98"], ["2014/11/08", "129"], ["2014/11/09", "128"], ["2014/11/10", "126"], ["2014/11/11", "129"], ["2014/11/12", "122"], ["2014/11/13", "133"], ["2014/11/14", "124"], ["2014/11/15", "110"], ["2014/11/16", "92"], ["2014/11/17", "123"], ["2014/11/18", "83"], ["2014/11/19", "91"], ["2014/11/20", "80"], ["2014/11/21", "90"], ["2014/11/22", "118"], ["2014/11/23", "135"], ["2014/11/24", "113"], ["2014/11/25", "91"], ["2014/11/26", "64"], ["2014/11/27", "88"], ["2014/11/28", "95"], ["2014/11/29", "49"], ["2014/11/30", "31"], ["2014/12/01", "24"], ["2014/12/02", "14"], ["2014/12/03", "10"], ["2014/12/04", "15"], ["2014/12/05", "53"], ["2014/12/06", "91"], ["2014/12/07", "67"], ["2014/12/08", "49"], ["2014/12/09", "49"], ["2014/12/10", "99"], ["2014/12/11", "77"], ["2014/12/12", "94"], ["2014/12/13", "68"], ["2014/12/14", "48"], ["2014/12/15", "79"], ["2014/12/16", "78"], ["2014/12/17", "106"], ["2014/12/18", "125"], ["2014/12/19", "124"], ["2014/12/20", "91"], ["2014/12/21", "103"], ["2014/12/22", "128"], ["2014/12/23", "128"], ["2014/12/24", "100"], ["2014/12/25", "79"], ["2014/12/26", "52"], ["2014/12/27", "29"], ["2014/12/28", "34"], ["2014/12/29", "56"], ["2014/12/30", "65"], ["2014/12/31", "76"], ["2015/01/01", "47"]]
    </textarea>

    <h2 align="center"> Maximum temperature in De Bilt (NL) in the year 2014</h2>
    <div class="wrapper" align="center" >
      <canvas class="wrapper" id="canvas" height="550" width="1000">
      </canvas>
      <canvas class="wrapper" id="canvas_interactive" height="550" width="1000" >
      </canvas>
    </div>
    <div id="div_temp" style="position:absolute; visibility:hidden">
    </div>
    <div id="div_date" style="position:absolute; visibility:hidden">
    </div>

    <style>
      canvas {
          position: absolute;
          top: 0;
          left: 0;
      }
      .wrapper {
      position: relative;
      width: 1000px;
      height: 550px;
      }
      .wrapper canvas {
      position: absolute;
          top: 0;
          left: 0;
      }


      #div_date {
        transform: rotate(90deg);
        color: blue;
      }

      #div_temp {
        color: red;
      }
    </style>


    <script>

      // modifies data from rawdata to time-list and temp_list
      rawdata = document.getElementById("rawdata").value
      data = JSON.parse(rawdata);
      var time_list = []
      var temp_list = []
      for(day = 0, days = data.length; day < days; day++){
        date = data[day][0]
        time = (new Date(date)).getTime()
        time_list.push(time)
        temp = data[day][1]
        temp_list.push(temp)
      }

      // select canvas element create 2d rendering context
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');

      // returns a function where x is tranfered to location on canvas
      function createTransform(domain, range){
        var alpha = (range[1] - range[0]) / (domain[1] - domain[0]);
        var beta = range[0] - (alpha * domain[0])
        return function(x){
	        return alpha * x + beta;
        };
      }

      // returns function to calculate x and y coordinates
      xtransform = createTransform([1388530800000, 1419980400000], [105, 1000])
      ytransform = createTransform([-100, 350], [500, 0])

      //  draw lines between coordinates
      ctx.beginPath();
      for (i = 0; i < temp_list.length - 1; i++){
        ctx.moveTo(xtransform(time_list[i]), ytransform(temp_list[i]));
        ctx.lineTo(xtransform(time_list[i + 1]), ytransform(temp_list[i + 1]));
      }
      ctx.strokeStyle = 'grey'
      ctx.stroke()

      // line x-axis
      ctx.beginPath();
      ctx.strokeStyle = 'black';
      ctx.moveTo(105,500);
      ctx.lineTo(1000,500);
      ctx.stroke();
      // line y-axis
      ctx.beginPath();
      ctx.strokeStyle = 'black';
      ctx.moveTo(105,500);
      ctx.lineTo(105,0);
      ctx.stroke();

      // 0 degrees line
      ctx.beginPath();
      ctx.moveTo(105, ytransform(0));
      ctx.lineTo(1000, ytransform(0));
      ctx.setLineDash([10,10])
      ctx.strokeStyle = 'black'
      ctx.stroke();

      // stripes for the x-axis
      for (i = 0; i < 12; i++){
        location_x = 105 + (895/12) * i
        ctx.beginPath();
        ctx.moveTo(location_x ,495)
        ctx.lineTo(location_x ,505);
        ctx.strokeStyle = 'black'
        ctx.stroke();
      }
      ctx.font = "8pt helvetica"
      // months for x-axis index
      months = ["2014/01/01", "2014/02/01", "2014/03/01", "2014/04/01", "2014/05/01",
      "2014/06/01", "2014/07/01", "2014/08/01", "2014/09/01",
      "2014/10/01", "2014/11/01", "2014/12/01"];

      for (i = 0; i < 12; i++){
        ctx.fillText(months[i], (105+i*75), 520);

      }

      // stripes for the y-axis
      for (i = 0; i < 9; i++){
        location_y = (500/9) * i
        ctx.beginPath();
        ctx.moveTo(100,location_y)
        ctx.lineTo(110,location_y);
        ctx.strokeStyle = 'black'
        ctx.stroke();
      }

      // temperatures for the y-axis
      temperatures = ["35", "30", "25", "20", "15",
      "10", "5", "0", "-5",
      "-10"];

      for (i = 0; i < 10; i++){
        ctx.fillText(temperatures[i], 85, (10 + i*55));
      }

      // select interactive canvas element create 2d rendering context
      var canvas_int = document.getElementById('canvas_interactive');
      var ctx_int = canvas_int.getContext('2d');

      // get the position of the mouse
      function getMousePos(canvas_int, event) {
        var rect = canvas_int.getBoundingClientRect();
        return {
          x:  event.clientX - rect.left,
          y: event.clientY - rect.top
        };
      }

      // listen for mouse movement
      canvas_int.addEventListener('mousemove', function(evt) {

        var mousePos = getMousePos(canvas_int, event);

        // what is the index of the x-coordinate
        xtransform_reverse = xtransform = createTransform([105, 1000], [0, 365])
        var index = xtransform_reverse(mousePos.x)
        index = Math.round(index)

        // what is the y-coordinate at index
        y_coordinate = ytransform(temp_list[index])

        // clears ctx_int
        ctx_int.clearRect(0, 0, 1000, 550)
        ctx_int.restore()

        // draws big circle
        ctx_int.beginPath();
        ctx_int.arc(mousePos.x,y_coordinate,10,0,180);
        ctx_int.strokeStyle="purple";
        ctx_int.stroke();

        // draws small circle
        ctx_int.beginPath();
        ctx_int.arc(mousePos.x,y_coordinate,4,0,180);
        ctx_int.stroke();

        // draws x line to circle
        ctx_int.beginPath();
        ctx_int.moveTo(105,y_coordinate);
        ctx_int.lineTo((mousePos.x - 5),y_coordinate);
        ctx_int.strokeStyle="black";
        ctx_int.stroke();
        ctx_int.beginPath();
        ctx_int.moveTo((mousePos.x + 5),y_coordinate);
        ctx_int.lineTo(1000,y_coordinate);
        ctx_int.stroke();

        // draws y line to circle
        ctx_int.beginPath();
        ctx_int.moveTo(mousePos.x,0);
        ctx_int.lineTo(mousePos.x,(y_coordinate - 5));
        ctx_int.stroke();
        ctx_int.beginPath();
        ctx_int.moveTo(mousePos.x,(y_coordinate + 5));
        ctx_int.lineTo(mousePos.x, 500);
        ctx_int.stroke();

        // what is the temperature and date at index
        var temp_index = data[index][1]
        var date_index = data[index][0]

        // shows date and temperature after 1 second when mouse moved
        show_date_temp(mousePos.x, y_coordinate, date_index, temp_index)
        setTimeout(function() {
          div_temp.style.visibility = "visible";
          div_date.style.visibility = "visible";
        }, 500);

        // function which modifies both divs to values
      })
      function show_date_temp(x, y, date_index, temp_index) {
        var div_date = document.getElementById('div_date');
        div_date.style.visibility = "hidden";
        div_date.style.left = (x - 40) + 'px';
        div_date.style.top = (y + 250) + 'px';
        div_date.innerHTML = "Date: " + date_index
        var div_temp = document.getElementById('div_temp');
        div_temp.style.visibility = "hidden";
        div_temp.style.left = (x - 200) + 'px';
        div_temp.style.top = (y + 95) + 'px';
        div_temp.innerHTML = "Degrees: " + temp_index/10 + " C"
        // Time function for delay of div
	     }

    </script>
  </body>
</html
